/*!
 UI components 
 (c) Sean Hogan, 2008,2012,2014
 Mozilla Public License v2.0 (http://mozilla.org/MPL/2.0/)
*/
Meeko.sprockets.UI=(function(){var k=Meeko.stuff,m=Meeko.DOM;var e=Meeko.sprockets,d=e.Base,h=e.RoleType;var f=e.evolve(h,{role:"group"});var b=e.evolve(h,{role:"treeitem",selected:{type:"boolean",can:function(){return !this.element.ariaFind("group");},get:function(){return !!this.aria("selected");},set:function(n){this.aria("selected",n);}},expanded:{type:"boolean",can:function(){return !!this.element.ariaFind("group");},get:function(){return !!this.aria("expanded");},set:function(n){var o=this.element.ariaFind("group");o.ariaToggle("hidden",!n);this.aria("expanded",!!n);}}});var c=e.evolve(h,{role:"tree",activedescendant:{type:"node",get:function(){var o=this.element.ariaFindAll("treeitem");for(var r=o.length,p=0;p<r;p++){var q=o[p];if(q.ariaGet("selected")){return q;}}},set:function(n){var o=this.ariaGet("activedescendant");if(o){o.ariaToggle("selected",false);}n.ariaToggle("selected",true);this.signalChange();}},signalChange:function(){this.trigger({type:"change"});}});var a=e.evolve(h,{role:"frame",activedescendant:{set:function(o){var n=this.element;if(n===o||!n.contains(o)){throw Error("set activedescendant failed: item is not descendant of ScrollBox");}n.scrollTop=o.offsetTop-n.offsetTop;}}});var j=h;var i=e.evolve(h,{role:"group",owns:{get:function(){return k.map(this.element.children);}},activedescendant:{set:function(p){var o=this.element;var n=this.ariaGet("owns");if(!k.includes(n,p)){throw Error("set activedescendant failed: item is not child of SwitchBox");}k.forEach(n,function(q){if(q===p){q.ariaToggle("hidden",false);}else{q.ariaToggle("hidden",true);}});}},initialize:function(){this.ariaSet("activedescendant",this.ariaGet("owns")[0]);}});var g=e.evolve(h,{getTable:function(){var n=this.element;if(n.tagName.toLowerCase()==="table"){return n;}return m.find("table",n);},getColumns:function(){var n=this.getTable();return n.tHead.rows[0].cells;},sort:function(r,v,u){var z=this.getTable();var C=z.tBodies;for(var s=0,q=C.length;s<q;s++){var w=C[s];var B=w.rows;var y=[];for(var t=0,p=B.length;t<p;t++){var A=B[t];var x=A.cells[r];var o=new String(x.firstChild.nodeValue);o.row=A;y.push(o);}switch(v){case"string":y=y.sort();break;case"number":y=y.sort(function(D,n){return Number(D)-Number(n);});break;default:throw Error("Unrecognized sort type: "+v);break;}if(u){y=y.reverse();}for(var p=y.length,t=0;t<p;t++){var o=y[t];var A=o.row;w.removeChild(A);if(t==p-1){w.appendChild(A);}else{w.insertBefore(A,w.rows[t]);}}}},toggleColumnSortState:function(r){var w="string";var x=this.getColumns();var q=x[r];var p=new d(q);if(p.hasClass("number")){w="number";}if(p.hasClass("string")){w="string";}var t=p.hasClass("sortable");var v=p.hasClass("sorted");var u=p.hasClass("reversed");if(!t){return;}if(!v){this.sort(r,w,false);p.addClass("sorted");p.removeClass("reversed");}else{this.sort(r,w,!u);if(u){p.removeClass("reversed");}else{p.addClass("reversed");}}for(var o=x.length,s=0;s<o;s++){if(r!=s){q=x[s];p=new d(q);p.removeClass("sorted");p.removeClass("reversed");}}}});var l=e.evolve(h,{encode:function(){var o=[];k.forEach(this.elements,function(p){if(p.name){o.push(p.name+"="+encodeURIComponent(p.value));}});var n=o.join("&");return n;}});return{RoleType:h,Group:f,TreeItem:b,Tree:c,Panel:j,ScrollBox:a,SwitchBox:i,Table:g,WF2FormElement:l};})();